import{d as e,r as a,c as l,w as s,a as t,u as r,b as i,o,e as n,f as u,g as d,h as m,i as c,_ as p}from"./index-DOZqpDgu.js";import{a as v}from"./api-O7hkGn9P.js";const f=p(e({__name:"LoginView",setup(e){const p=r(),f=i(),b=a(""),y=a(""),g=a(!1),x=a(!1),V=a(""),w={required:e=>!!e||"Requerido",email:e=>/.+@.+\..+/.test(e)||"Email inválido",min6:e=>(e?.length??0)>=6||"Mínimo 6 caracteres"},_=async()=>{V.value="",g.value=!0;try{const{data:e}=await v.post("/login",{email:b.value,password:y.value});localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.usuario));const a=f.query.redirect||"/usuarios";p.push(a)}catch(e){V.value=e?.response?.data?.message||e?.response?.data?.errors?.email?.[0]||"No se pudo iniciar sesión. Verifica tus credenciales."}finally{g.value=!1}};return(e,a)=>{const r=t("v-text-field"),i=t("v-alert"),p=t("v-btn"),v=t("v-form"),f=t("v-card"),h=t("v-container");return o(),l(h,{class:"d-flex align-center justify-center fill-height"},{default:s(()=>[n(f,{class:"w-full max-w-md p-6 rounded-2xl"},{default:s(()=>[a[4]||(a[4]=u("div",{class:"text-center mb-4"},[u("h2",{class:"text-xl font-semibold"},"Iniciar sesión"),u("p",{class:"text-sm text-gray-500"},"UMG 2025")],-1)),n(v,{modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value=e),onSubmit:d(_,["prevent"])},{default:s(()=>[n(r,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e),label:"Email",type:"email",rules:[w.required,w.email],"prepend-inner-icon":"mdi-email",density:"comfortable",clearable:""},null,8,["modelValue","rules"]),n(r,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value=e),label:"Password",type:"password",rules:[w.required,w.min6],"prepend-inner-icon":"mdi-lock",density:"comfortable",clearable:""},null,8,["modelValue","rules"]),V.value?(o(),l(i,{key:0,type:"error",variant:"tonal",class:"mb-3",text:V.value,density:"comfortable"},null,8,["text"])):m("",!0),n(p,{loading:g.value,disabled:!x.value||g.value,type:"submit",color:"primary",class:"w-full"},{default:s(()=>[...a[3]||(a[3]=[c(" Entrar ",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-aabd25ae"]]);export{f as default};
